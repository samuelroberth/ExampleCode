(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     66961,       1850]
NotebookOptionsPosition[     62656,       1699]
NotebookOutlinePosition[     63247,       1721]
CellTagsIndexPosition[     63204,       1718]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.667216232875883*^9}],

Cell[CellGroupData[{

Cell["Author: Samuel Harris", "Subsection",
 CellChangeTimes->{{3.667162374098757*^9, 3.667162377241796*^9}}],

Cell[CellGroupData[{

Cell["Read in Functions", "Subsubsection",
 CellChangeTimes->{{3.667162384449489*^9, 3.667162388673417*^9}}],

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<C:\\\\Users\\\\harri340\\\\Desktop\\\\ARlags.m\>\"",
   "]"}]], "Input",
 CellChangeTimes->{{3.4893449403894167`*^9, 3.4893449433893595`*^9}, 
   3.6662845105168724`*^9, {3.66628985373114*^9, 3.6662898941551824`*^9}, {
   3.6663799244818*^9, 3.6663799326876206`*^9}, {3.666621901158904*^9, 
   3.666621913042038*^9}, {3.6671622927272387`*^9, 3.667162293638947*^9}, {
   3.6671660962726707`*^9, 3.6671660992211084`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problem 1", "Subsubsection",
 CellChangeTimes->{{3.667162394805101*^9, 3.6671624264561567`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"See", " ", "Attached", " ", "Sheet"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.667162429010725*^9, 3.667162437668304*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problem 2 (Critical Values)", "Subsubsection",
 CellChangeTimes->{{3.667162403946741*^9, 3.6671624149545937`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "100000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", "0", ",", "0", ",", "0", ",", "500", ",", "0.2"}], 
        "]"}], ",", " ", "1", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "3", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"critVals", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".95"}], "]"}], "]"}], ",", " ", 
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".99"}], "]"}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.667162294801262*^9, 3.667162341707713*^9}, 
   3.6671629829219313`*^9, 3.6671630917606983`*^9, {3.6671661161629257`*^9, 
   3.6671661235262203`*^9}, {3.6671666111339836`*^9, 
   3.6671666156746597`*^9}, {3.6671668142473464`*^9, 3.6671668162758274`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.6193368791821847`", ",", "2.337773028697866`"}], "}"}]], "Output",
 CellChangeTimes->{{3.667166575503661*^9, 3.667166604143526*^9}, 
   3.6671666596926975`*^9, 3.667167233949663*^9, 3.667167791983059*^9, 
   3.6671681540941677`*^9, 3.667217995752734*^9, 3.6672180357527337`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "100000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", "0", ",", "0", ",", "0", ",", "500", ",", "0.001"}], 
        "]"}], ",", " ", "1", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "3", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"critVals", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".95"}], "]"}], "]"}], ",", " ", 
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".99"}], "]"}], "]"}]}], "}"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.617140937096582`", ",", "2.346772450846485`"}], "}"}]], "Output",
 CellChangeTimes->{3.667168112644702*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "100000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", "0", ",", "0", ",", "0", ",", "500", ",", "0.1"}], 
        "]"}], ",", " ", "1", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "3", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"critVals", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".95"}], "]"}], "]"}], ",", " ", 
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".99"}], "]"}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.6671680170004888`*^9, 3.6671680170784893`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.6162356496507584`", ",", "2.325795637584107`"}], "}"}]], "Output",
 CellChangeTimes->{3.667168071195236*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "100000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", "0", ",", "0", ",", "0", ",", "500", ",", "0.01"}], 
        "]"}], ",", " ", "2", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "3", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"critVals", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".95"}], "]"}], "]"}], ",", " ", 
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".99"}], "]"}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.667168394921733*^9, 3.6671683973120437`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.6289213995434673`", ",", "2.339250188355351`"}], "}"}]], "Output",
 CellChangeTimes->{3.6671684920314116`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "100000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", "0", ",", "0", ",", "0", ",", "500", ",", "0.01"}], 
        "]"}], ",", " ", "3", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "3", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"critVals", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".95"}], "]"}], "]"}], ",", " ", 
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".99"}], "]"}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.6671684014425807`*^9, 3.667168402992782*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.6087613819579083`", ",", "2.3404479717440108`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.667168449580345*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "critical", " ", "value", " ", "appears", " ", "to", " ", 
     "be", " ", "around", " ", "1.616"}], "-", 
    RowBox[{"1.617", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Possibly", " ", "up", " ", "to", " ", "1.62"}], ")"}], ".", 
      " ", "Different"}], " ", "choices", " ", "of", " ", "the", " ", 
     "number", " ", "of", " ", "lags", " ", "seem", " ", "to", " ", "change", 
     " ", "the", " ", "critical", " ", 
     RowBox[{"value", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Some", " ", "other", " ", "critical", " ", "values", " ", "follow", " ", 
     "for", " ", "different", " ", "choices", " ", "of", " ", "a"}], ",", " ",
     "p0", ",", " ", 
    RowBox[{"and", " ", 
     RowBox[{"pstar", ".", " ", "I"}], " ", "believe", " ", "these", " ", 
     "will", " ", "be", " ", 
     RowBox[{"biased", "."}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.667168164749036*^9, 3.6671681941552243`*^9}, {
  3.6671682246689634`*^9, 3.6671682413297634`*^9}, {3.6671684200688167`*^9, 
  3.6671684259788694`*^9}, {3.667168476196226*^9, 3.667168492041413*^9}, {
  3.6672180472538834`*^9, 3.6672180671758757`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "100000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"data1", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", ".02", ",", "10", ",", "20", ",", "500", ",", "0.2"}], 
        "]"}], ",", " ", "1", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats1", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data1", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "3", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"critVals1", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"tStats1", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".95"}], "]"}], "]"}], ",", " ", 
    RowBox[{"tStats1", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".99"}], "]"}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.6671666691797476`*^9, 3.6671666845493917`*^9}, {
  3.667166760648637*^9, 3.667166784257035*^9}, {3.6671668195838118`*^9, 
  3.667166821487463*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.633275418873197`", ",", "2.342143552886363`"}], "}"}]], "Output",
 CellChangeTimes->{3.667166724448053*^9, 3.667166820114338*^9, 
  3.667166970709656*^9, 3.6671672776154623`*^9, 3.66716738880163*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "100000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"data2", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", ".05", ",", "5", ",", "10", ",", "500", ",", "0.2"}], 
        "]"}], ",", " ", "1", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats2", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data2", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "3", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"critVals2", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"tStats2", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".95"}], "]"}], "]"}], ",", " ", 
    RowBox[{"tStats2", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".99"}], "]"}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.667166734122347*^9, 3.6671667860514603`*^9}, {
  3.6671668238748293`*^9, 3.667166824452166*^9}, {3.667166871840603*^9, 
  3.6671668763500724`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.6431283635101612`", ",", "2.3466357704961687`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.667166781479576*^9, 3.66716685993498*^9, 
  3.667166919599469*^9, 3.6671670507448378`*^9, 3.667167316491922*^9, 
  3.667167606900814*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "100000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", "0", ",", "0", ",", "0", ",", "500", ",", "0.001"}], 
        "]"}], ",", " ", "2", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "3", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"critVals", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".95"}], "]"}], "]"}], ",", " ", 
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".99"}], "]"}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.667167407834606*^9, 3.667167408006215*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.6289059606036205`", ",", "2.349485520584046`"}], "}"}]], "Output",
 CellChangeTimes->{3.667167451423241*^9, 3.6671676484602985`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "100000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", "0", ",", "0", ",", "0", ",", "500", ",", "0.01"}], 
        "]"}], ",", " ", "3", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "3", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"critVals", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".95"}], "]"}], "]"}], ",", " ", 
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".99"}], "]"}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.667167463389055*^9, 3.6671674636386676`*^9}, 
   3.6671678153523083`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.6154724413946522`", ",", "2.3296447394282005`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6671675574150763`*^9, 3.667167692421944*^9, 
  3.667167861014386*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "100000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", "0", ",", "0", ",", "0", ",", "500", ",", "0.1"}], 
        "]"}], ",", " ", "4", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "3", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"critVals", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".95"}], "]"}], "]"}], ",", " ", 
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".99"}], "]"}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.6671674676948757`*^9, 3.667167467819682*^9}, {
  3.667167808456976*^9, 3.667167811592636*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.6307476527436375`", ",", "2.333484203254221`"}], "}"}]], "Output",
 CellChangeTimes->{3.6671675131868086`*^9, 3.6671677390824413`*^9, 
  3.6671679076280828`*^9, 3.6672175811067743`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "100000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", ".02", ",", "10", ",", "15", ",", "500", ",", "0.1"}], 
        "]"}], ",", " ", "1", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "3", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{"critVals", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".95"}], "]"}], "]"}], ",", " ", 
    RowBox[{"tStats", "[", 
     RowBox[{"[", 
      RowBox[{"n", "*", ".99"}], "]"}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.667167927034712*^9, 3.6671679355835667`*^9}, 
   3.6671679892479105`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.084736140806503`", ",", "2.796161172315724`"}], "}"}]], "Output",
 CellChangeTimes->{3.6671679759410257`*^9, 3.667168030619376*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problem 3 (Lags vs. No Lags)", "Subsubsection",
 CellChangeTimes->{{3.667164051799099*^9, 3.66716405674571*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"withoutLags", "=", 
  RowBox[{"LagTest", "[", 
   RowBox[{
    RowBox[{"PriceSequenceLags", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
        " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
      ".04", ",", "10", ",", "20", ",", "5000", ",", "0.3"}], "]"}], ",", " ",
     "0", ",", " ", "0", ",", " ", "20"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.667164153466165*^9, 3.667164156044793*^9}, 
   3.6671642869441967`*^9, {3.667164332607181*^9, 3.667164332934658*^9}, 
   3.667164370685842*^9, {3.667164445989113*^9, 3.6671644845457983`*^9}, {
   3.667164564857346*^9, 3.6671646014237537`*^9}, {3.667165330856811*^9, 
   3.667165336531444*^9}, {3.667165404181333*^9, 3.667165412080969*^9}, {
   3.667165447303832*^9, 3.667165449133726*^9}, {3.6671670445198793`*^9, 
   3.667167048966278*^9}, {3.667167111715109*^9, 3.667167124945096*^9}, 
   3.667168824022416*^9, {3.667168967184965*^9, 3.667168967944995*^9}, {
   3.66721814522159*^9, 3.6672181452315903`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    StyleBox[
     TagBox[GridBox[{
        {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
        {"a", 
         RowBox[{"-", "0.03760011790966519`"}], "0.0034763751561305758`", 
         RowBox[{"-", "10.815897658041168`"}], "5.7451247314064505`*^-27"}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
       GridBoxDividers->{
        "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
         "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       GridBoxSpacings->{
        "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
      "Grid"], "DialogStyle",
     StripOnInput->False], ",", "0.022870775418563548`"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6671641757412033`*^9, {3.667164279318841*^9, 3.667164291384845*^9}, 
   3.667164350865872*^9, 3.6671644666049013`*^9, {3.6671644986193247`*^9, 
   3.667164527920823*^9}, {3.6671645663840723`*^9, 3.667164584523802*^9}, 
   3.6671653557982683`*^9, 3.6671670993119955`*^9, 3.6671671302339706`*^9, {
   3.667168564550838*^9, 3.6671685926660132`*^9}, {3.667168700283806*^9, 
   3.667168731259754*^9}, 3.667168824622452*^9, 3.6671689691050415`*^9, 
   3.667218151875928*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"withoutLags2", "=", 
  RowBox[{"LagTest", "[", 
   RowBox[{
    RowBox[{"PriceSequenceLags", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
        " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
      ".02", ",", "10", ",", "20", ",", "5000", ",", "0.3"}], "]"}], ",", " ",
     "1", ",", " ", "0", ",", " ", "20"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6671691657424173`*^9, 3.6671691716346626`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    StyleBox[
     TagBox[GridBox[{
        {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
        {"a", 
         RowBox[{"-", "0.022267091958656143`"}], "0.002675349293724106`", 
         RowBox[{"-", "8.323059725655558`"}], "1.0948933968310397`*^-16"},
        {"b1", "0.018444600504024168`", "0.014087764841685602`", 
         "1.3092637981467947`", "0.19050520640675328`"}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
       GridBoxDividers->{
        "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
         "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       GridBoxSpacings->{
        "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
      "Grid"], "DialogStyle",
     StripOnInput->False], ",", "0.013767602321213804`"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6671691666924553`*^9, 3.667169174154763*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"withoutLags3", "=", 
  RowBox[{"LagTest", "[", 
   RowBox[{
    RowBox[{"PriceSequenceLags", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
        " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
      ".02", ",", "10", ",", "20", ",", "5000", ",", "0.3"}], "]"}], ",", " ",
     "2", ",", " ", "0", ",", " ", "20"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6671691831371326`*^9, 3.667169187877322*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    StyleBox[
     TagBox[GridBox[{
        {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
        {"a", 
         RowBox[{"-", "0.021152756906433014`"}], "0.002644126793820809`", 
         RowBox[{"-", "7.999902635480999`"}], "1.5354404981798505`*^-15"},
        {"b1", 
         RowBox[{"-", "0.00020926005303082795`"}], "0.01409214012741283`", 
         RowBox[{"-", "0.014849416138274372`"}], "0.9881529084748694`"},
        {"b2", 
         RowBox[{"-", "0.016510835772303823`"}], "0.01409055235810884`", 
         RowBox[{"-", "1.171766397276978`"}], "0.2413467335763223`"}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
       GridBoxDividers->{
        "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
         "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       GridBoxSpacings->{
        "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
      "Grid"], "DialogStyle",
     StripOnInput->False], ",", "0.013315933161322837`"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6671691887073555`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"withLags", " ", "=", " ", 
  RowBox[{"LagTest", "[", 
   RowBox[{
    RowBox[{"PriceSequenceLags", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       ".5", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
        " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
      ".02", ",", "10", ",", "20", ",", "5000", ",", "0.3"}], "]"}], ",", " ",
     "1", ",", " ", "0", ",", " ", "20"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.667164121820809*^9, 3.667164172071971*^9}, 
   3.6671642861741333`*^9, {3.667164335343156*^9, 3.6671643356427717`*^9}, 
   3.66716437184937*^9, {3.667164459071946*^9, 3.667164511100819*^9}, {
   3.667165338011585*^9, 3.6671653444247913`*^9}, {3.6671654145372887`*^9, 
   3.667165445994001*^9}, {3.667167052164565*^9, 3.667167055472062*^9}, {
   3.6671671128384094`*^9, 3.6671671260683966`*^9}, {3.6671687838879747`*^9, 
   3.667168785188052*^9}, 3.6671688217302723`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    StyleBox[
     TagBox[GridBox[{
        {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
        {"a", 
         RowBox[{"-", "0.019892050606250735`"}], "0.0018912111873944772`", 
         RowBox[{"-", "10.518154047965435`"}], "1.3171287161620676`*^-25"},
        {"b1", "0.5262324848553037`", "0.011997880296851999`", 
         "43.860454666594435`", 
         "8.602527880971082510452271272564120307218170652683`11.\
70421618016439*^-356"}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
       GridBoxDividers->{
        "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
         "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       GridBoxSpacings->{
        "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
      "Grid"], "DialogStyle",
     StripOnInput->False], ",", "0.2839952268359579`"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.667164178544783*^9, {3.6671642765360327`*^9, 3.667164293926449*^9}, 
   3.667164348726451*^9, {3.6671644686997347`*^9, 3.667164526116744*^9}, 
   3.66716535870472*^9, {3.667167102042241*^9, 3.6671671321217403`*^9}, {
   3.667168590023661*^9, 3.6671685995589185`*^9}, {3.667168736752089*^9, 
   3.667168756670326*^9}, {3.667168804993251*^9, 3.667168822410313*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"withLags2", "=", 
  RowBox[{"LagTest", "[", 
   RowBox[{
    RowBox[{"PriceSequenceLags", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       ".2", ",", " ", ".1", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",",
         " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
      ".02", ",", "10", ",", "20", ",", "5000", ",", "0.3"}], "]"}], ",", " ",
     "2", ",", " ", "0", ",", " ", "20"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.667164187110691*^9, 3.667164202248705*^9}, {
   3.6671642878062553`*^9, 3.667164307697591*^9}, {3.667164338020982*^9, 
   3.667164338400676*^9}, 3.667164372609886*^9, {3.6671644617696543`*^9, 
   3.667164523556706*^9}, {3.667165345751338*^9, 3.6671653486894627`*^9}, {
   3.667165420203105*^9, 3.6671654360595493`*^9}, {3.6671670580618944`*^9, 
   3.6671670621182585`*^9}, {3.667167113868102*^9, 3.6671671273633127`*^9}, {
   3.6671687872381754`*^9, 3.667168815745901*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    StyleBox[
     TagBox[GridBox[{
        {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
        {"a", 
         RowBox[{"-", "0.021055208944558403`"}], "0.002331913520964659`", 
         RowBox[{"-", "9.02915513601394`"}], "2.423457649681059`*^-19"},
        {"b1", "0.18185888862819724`", "0.013997402725944416`", 
         "12.99233094802072`", "5.545456520378668`*^-38"},
        {"b2", "0.09852678942996115`", "0.014035788160291237`", 
         "7.019683419610457`", "2.5212474188416453`*^-12"}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
       GridBoxDividers->{
        "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
         "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       GridBoxSpacings->{
        "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
      "Grid"], "DialogStyle",
     StripOnInput->False], ",", "0.059795863182671286`"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.667164237209841*^9, 3.667164257127788*^9}, {
   3.6671642979024353`*^9, 3.667164315269548*^9}, 3.667164346249886*^9, {
   3.667164470554192*^9, 3.667164524132697*^9}, 3.667165361074045*^9, {
   3.66716710425764*^9, 3.6671671343995447`*^9}, 3.6671686081720467`*^9, {
   3.667168760902585*^9, 3.667168763444743*^9}, {3.667168802661106*^9, 
   3.6671688165259476`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"withLags3", "=", 
  RowBox[{"LagTest", "[", 
   RowBox[{
    RowBox[{"PriceSequenceLags", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       ".4", ",", " ", ".2", ",", " ", ".1", ",", " ", "0", ",", " ", "0", 
        ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], "}"}], 
      ",", ".02", ",", "10", ",", "20", ",", "5000", ",", "0.3"}], "]"}], ",",
     " ", "3", ",", " ", "0", ",", " ", "20"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.667164268226309*^9, 3.667164310257506*^9}, {
   3.6671643408249197`*^9, 3.66716434149049*^9}, 3.6671643734557962`*^9, {
   3.667164464775977*^9, 3.667164518716641*^9}, {3.667165349879548*^9, 
   3.667165353371011*^9}, {3.667165424996986*^9, 3.667165426232297*^9}, {
   3.6671670925565896`*^9, 3.6671671283306*^9}, {3.667168795348662*^9, 
   3.667168819018103*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    StyleBox[
     TagBox[GridBox[{
        {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
        {"a", 
         RowBox[{"-", "0.023334191763553228`"}], "0.001652948770732415`", 
         RowBox[{"-", "14.116705960109062`"}], "2.1186180212363354`*^-44"},
        {"b1", "0.4005292209434572`", "0.013861045944786819`", 
         "28.896031550497636`", "6.49990046415748`*^-170"},
        {"b2", "0.21377080946892155`", "0.014728165648145346`", 
         "14.51442186188616`", "8.697150765157538`*^-47"},
        {"b3", "0.11104993687694882`", "0.014046902952026881`", 
         "7.905652744680278`", "3.255643636902873`*^-15"}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
       GridBoxDividers->{
        "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
         "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       GridBoxSpacings->{
        "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
      "Grid"], "DialogStyle",
     StripOnInput->False], ",", "0.3839570586849316`"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.667164271783064*^9, 3.667164310931933*^9}, 
   3.667164342860292*^9, 3.667164374802987*^9, {3.6671644724243526`*^9, 
   3.667164520079406*^9}, 3.667165363170505*^9, {3.667167107362318*^9, 
   3.66716713691137*^9}, 3.6671686116745105`*^9, {3.6671688007089834`*^9, 
   3.667168819699144*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"For", " ", "long", " ", "sequences"}], ",", " ", 
   RowBox[{
   "the", " ", "adjustment", " ", "rate", " ", "measurements", " ", "seem", 
    " ", "to", " ", "be", " ", "very", " ", 
    RowBox[{"similar", ".", " ", "The"}], " ", "inclusion", " ", "of", " ", 
    "more", " ", "lags", " ", "in", " ", "LagTest", " ", "does", " ", "not", 
    " ", "seem", " ", "to", " ", "affect", " ", "the", " ", "detection", " ", 
    "of", " ", "a"}], ",", " ", 
   RowBox[{
   "but", " ", "our", " ", "a", " ", "detected", " ", "seems", " ", "to", " ",
     "be", " ", "the", " ", "negative", " ", "of", " ", "the", " ", "actual", 
    " ", 
    RowBox[{"value", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.667168827934656*^9, 3.667168852228614*^9}, {
  3.667169200959856*^9, 3.6671692195205984`*^9}, {3.667218156858184*^9, 
  3.667218166968689*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", "10000"}], ";"}]], "Input",
 CellChangeTimes->{{3.667169085986727*^9, 3.6671690884168243`*^9}, {
   3.6671698648311076`*^9, 3.6671698678411674`*^9}, 3.667218122015879*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"data11", " ", "=", " ", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"LagTest", "[", 
        RowBox[{
         RowBox[{"PriceSequenceLags", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
             ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
            "}"}], ",", ".2", ",", "10", ",", "20", ",", "500", ",", "0.2"}], 
          "]"}], ",", " ", "0", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"tStats11", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{
        "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "4"}], 
        "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"Sign", ",", " ", 
          RowBox[{"tStats11", " ", "-", " ", "1.62"}]}], "]"}], ",", " ", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], "/", 
     RowBox[{"Length", "[", "tStats11", "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.667169091036929*^9, {3.6671693034126835`*^9, 3.6671693036826887`*^9}, {
   3.6671693800042152`*^9, 3.667169382644268*^9}, {3.6671694588532925`*^9, 
   3.667169459503306*^9}, {3.6671695421849594`*^9, 3.6671695428049717`*^9}, {
   3.667169577515666*^9, 3.6671695779656754`*^9}, {3.6671696984110374`*^9, 
   3.6671697015311*^9}, 3.6671697926688523`*^9, 3.667169889821607*^9, {
   3.667217592021508*^9, 3.667217608105528*^9}, 3.6672176547308397`*^9, {
   3.66721777500338*^9, 3.667217832083369*^9}, {3.6672178623463945`*^9, 
   3.6672178683069906`*^9}, {3.6672180750666647`*^9, 
   3.6672180900081587`*^9}, {3.6672183945056577`*^9, 3.667218403809984*^9}}],

Cell[BoxData["0.96016`"], "Output",
 CellChangeTimes->{3.667218210632936*^9, 3.6672184892260275`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"data12", " ", "=", " ", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"LagTest", "[", 
        RowBox[{
         RowBox[{"PriceSequenceLags", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
             ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
            "}"}], ",", ".2", ",", "10", ",", "20", ",", "500", ",", "0.2"}], 
          "]"}], ",", " ", "1", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"tStats12", "=", 
     RowBox[{"Sort", "[", 
      RowBox[{"data12", "[", 
       RowBox[{"[", 
        RowBox[{
        "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "4"}], 
        "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Position", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"Sign", ",", " ", 
          RowBox[{"tStats12", " ", "-", " ", "1.62"}]}], "]"}], ",", " ", 
        RowBox[{"-", "1"}]}], "]"}], "]"}], "/", 
     RowBox[{"Length", "[", "tStats12", "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.667169081186535*^9, {3.667169132531089*^9, 3.6671691326610937`*^9}, {
   3.6671693062427397`*^9, 3.667169306392743*^9}, {3.66716938474431*^9, 
   3.66716938725436*^9}, {3.667169461573347*^9, 3.6671694618633533`*^9}, {
   3.6671695444550047`*^9, 3.667169544825012*^9}, {3.6671695753356223`*^9, 
   3.66716957568563*^9}, 3.667169707901227*^9, {3.667217740565908*^9, 
   3.6672177407359505`*^9}, {3.667218077896948*^9, 3.6672180784069986`*^9}, {
   3.6672184067331057`*^9, 3.6672184098652315`*^9}}],

Cell[BoxData["1.`"], "Output",
 CellChangeTimes->{3.6671696848107653`*^9, 3.6672177808068333`*^9, 
  3.6672182259767714`*^9, 3.667218504141567*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data13", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", ".2", ",", "10", ",", "20", ",", "500", ",", "0.2"}], 
        "]"}], ",", " ", "2", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats13", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data13", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Sign", ",", " ", 
        RowBox[{"tStats13", "-", " ", "1.62"}]}], "]"}], ",", " ", 
      RowBox[{"-", "1"}]}], "]"}], "]"}], "/", 
   RowBox[{"Length", "[", "tStats13", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.6671690825765905`*^9, {3.6671691356312127`*^9, 3.667169135761218*^9}, {
   3.6671693087127895`*^9, 3.667169308802791*^9}, {3.667169388584387*^9, 
   3.6671693910644364`*^9}, {3.6671694633633833`*^9, 3.667169463603388*^9}, {
   3.6671695466850495`*^9, 3.667169573565587*^9}, 3.667169710381277*^9, {
   3.6672178771778774`*^9, 3.6672178774479046`*^9}, 3.6672180962684793`*^9, {
   3.6672183038340197`*^9, 3.6672183044640512`*^9}, {3.667218412267334*^9, 
   3.6672184188195343`*^9}}],

Cell[BoxData["1.`"], "Output",
 CellChangeTimes->{3.6672182401085367`*^9, 3.6672183845981936`*^9, 
  3.667218520108153*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data14", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", ".2", ",", "10", ",", "20", ",", "500", ",", "0.2"}], 
        "]"}], ",", " ", "3", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats14", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data14", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Sign", ",", " ", 
        RowBox[{"tStats14", "-", " ", "1.62"}]}], "]"}], ",", " ", 
      RowBox[{"-", "1"}]}], "]"}], "]"}], "/", 
   RowBox[{"Length", "[", "tStats14", "]"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.6671690836466336`*^9, {3.6671691381413136`*^9, 3.667169146211636*^9}, {
   3.6671693115728464`*^9, 3.667169320593027*^9}, {3.6671693921644583`*^9, 
   3.667169395194519*^9}, {3.6671694654934254`*^9, 3.6671694658934336`*^9}, 
   3.667169508364283*^9, {3.6671695491450987`*^9, 3.6671695711655393`*^9}, 
   3.6671697116913033`*^9, {3.6672178794681067`*^9, 3.667217879768137*^9}, {
   3.6672180980285673`*^9, 3.6672181113992357`*^9}, {3.667218299201785*^9, 
   3.6672182998118153`*^9}, {3.6672184207845955`*^9, 3.667218423875746*^9}}],

Cell[BoxData["1.`"], "Output",
 CellChangeTimes->{3.6672182545623317`*^9, 3.6672183998628607`*^9, 
  3.6672185381647887`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data15", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          ".3", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", ".2", ",", "10", ",", "20", ",", "500", ",", "0.2"}], 
        "]"}], ",", " ", "0", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats15", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data15", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "2", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Sign", ",", " ", 
        RowBox[{"tStats15", "-", " ", "1.62"}]}], "]"}], ",", " ", 
      RowBox[{"-", "1"}]}], "]"}], "]"}], "/", 
   RowBox[{"Length", "[", "tStats15", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6671693382933807`*^9, 3.667169338853392*^9}, {
   3.6671693960745363`*^9, 3.667169401834652*^9}, {3.667169469003496*^9, 
   3.667169469303502*^9}, 3.6671695074842653`*^9, {3.6671695514851456`*^9, 
   3.6671695673654633`*^9}, {3.6671696130992804`*^9, 3.6671696133742867`*^9}, 
   3.6671697151313715`*^9, {3.667217881928353*^9, 3.6672178821983795`*^9}, 
   3.667218113199326*^9, {3.6672181735390177`*^9, 3.6672181753791094`*^9}, {
   3.667218293437455*^9, 3.6672182942235146`*^9}, {3.6672184269178705`*^9, 
   3.6672184367731743`*^9}}],

Cell[BoxData["1.`"], "Output",
 CellChangeTimes->{3.6672177372650833`*^9, 3.6672181509058795`*^9, 
  3.667218271114234*^9, 3.6672184169294777`*^9, 3.66721855392235*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data16", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          ".3", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", ".2", ",", "10", ",", "20", ",", "500", ",", "0.2"}], 
        "]"}], ",", " ", "1", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats16", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data16", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "3", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Sign", ",", " ", 
        RowBox[{"tStats16", " ", "-", " ", "1.62"}]}], "]"}], ",", " ", 
      RowBox[{"-", "1"}]}], "]"}], "]"}], "/", 
   RowBox[{"Length", "[", "tStats16", "]"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.667169341473445*^9, 3.6671693418634524`*^9}, {
   3.667169402884673*^9, 3.667169405894733*^9}, {3.667169471113538*^9, 
   3.6671694713335423`*^9}, 3.667169511364343*^9, {3.667169554845213*^9, 
   3.667169564775411*^9}, {3.6671696161324987`*^9, 3.667169616291515*^9}, 
   3.667169717081411*^9, {3.6672182962266345`*^9, 3.667218296821666*^9}, {
   3.6672184392452707`*^9, 3.667218442463431*^9}}],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{3.6672182857550535`*^9, 3.6672184314000063`*^9, 
  3.6672185717929764`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data17", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          ".3", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", ".2", ",", "10", ",", "20", ",", "500", ",", "0.2"}], 
        "]"}], ",", " ", "2", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats17", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data17", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "3", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Sign", ",", " ", 
        RowBox[{"tStats17", "-", " ", "1.62"}]}], "]"}], ",", " ", 
      RowBox[{"-", "1"}]}], "]"}], "]"}], "/", 
   RowBox[{"Length", "[", "tStats17", "]"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6671693441134977`*^9, 3.667169344553506*^9}, {
   3.6671694070747566`*^9, 3.6671694119248533`*^9}, {3.6671694730035763`*^9, 
   3.6671694732235804`*^9}, 3.6671695134043837`*^9, {3.667169557945275*^9, 
   3.667169562405364*^9}, {3.667169618638687*^9, 3.6671696189857063`*^9}, 
   3.6671697189114475`*^9, {3.6672183098583574`*^9, 3.667218310405396*^9}, {
   3.667218445713528*^9, 3.667218455565895*^9}}],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{3.6672183000418267`*^9, 3.6672184464155507`*^9, 
  3.6672185900946245`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data17", " ", "=", " ", 
   RowBox[{"ParallelTable", "[", 
    RowBox[{
     RowBox[{"LagTest", "[", 
      RowBox[{
       RowBox[{"PriceSequenceLags", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          ".3", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
           ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
          "}"}], ",", ".2", ",", "10", ",", "20", ",", "500", ",", "0.2"}], 
        "]"}], ",", " ", "3", ",", " ", "0", ",", " ", "20"}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"tStats17", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"data17", "[", 
     RowBox[{"[", 
      RowBox[{
      "All", ",", "1", ",", "1", ",", "1", ",", "1", ",", "3", ",", "4"}], 
      "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Sign", ",", " ", 
        RowBox[{"tStats17", "-", " ", "1.62"}]}], "]"}], ",", " ", 
      RowBox[{"-", "1"}]}], "]"}], "]"}], "/", 
   RowBox[{"Length", "[", "tStats17", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6671696283164263`*^9, 3.6671696284774303`*^9}, 
   3.667169720381477*^9, {3.667218313285555*^9, 3.667218314015591*^9}, {
   3.6672184593780384`*^9, 3.6672184641841908`*^9}}],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{3.6672183148666334`*^9, 3.667218461808111*^9, 
  3.667218605157174*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "The", " ", "power", " ", "appears", " ", "to", " ", "be", " ", "very", " ",
    "poor", " ", "with", " ", "no", " ", "lag", " ", "variables", " ", "and", 
   " ", "very", " ", "high", " ", "when", " ", "lag", " ", "variables", " ", 
   "are", " ", 
   RowBox[{"included", "."}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6672181936500235`*^9, 3.6672181989483137`*^9}, {
  3.6672183750926723`*^9, 3.667218388369387*^9}, {3.667218589785606*^9, 
  3.6672185993559647`*^9}, {3.667218662238887*^9, 3.6672186757292914`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problem 4 (Vectorization)", "Subsubsection",
 CellChangeTimes->{{3.6672186980098815`*^9, 3.667218701529952*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "The", " ", "following", " ", "is", " ", "taken", " ", "from", " ", "the", 
   " ", 
   RowBox[{"Causality", ".", "m"}], " ", "code", " ", "by", " ", "Professor", 
   " ", "Gjerstad", " ", "which", " ", "vectorizes", " ", "the", " ", 
   "function", " ", "LagTest"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6672191187373548`*^9, 3.667219134147663*^9}, {
  3.6672192952174063`*^9, 3.66721932084042*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"LagTest", "[", 
    RowBox[{"data_", ",", " ", "L_", ",", " ", "c_", ",", " ", "Pe_"}], "]"}],
    ":=", " ", "\n", "       ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v0", ",", " ", "v1", ",", " ", "v2", ",", " ", "v", ",", " ", "r", ",",
        " ", "m", ",", " ", "s"}], "}"}], ",", " ", "\n", "              ", 
     RowBox[{
      RowBox[{"v0", " ", "=", " ", 
       RowBox[{
        RowBox[{"bc", "[", 
         RowBox[{"data", ",", " ", "Pe"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "              ", 
      RowBox[{"v1", " ", "=", " ", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"bc", "[", 
              RowBox[{"data", ",", " ", "Pe"}], "]"}], ",", " ", "1"}], "]"}],
            ",", " ", 
           RowBox[{"-", "1"}]}], "]"}], ",", " ", "L", ",", " ", "1"}], 
        "]"}]}], ";", "\n", "              ", 
      RowBox[{"v2", " ", "=", " ", 
       RowBox[{
        RowBox[{"bc", "[", 
         RowBox[{"data", ",", " ", "Pe"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\n", "               ", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "v0", "}"}], ",", " ", "v1", ",", " ", 
          RowBox[{"{", "v2", "}"}]}], "]"}], "]"}]}], ";", "\n", 
      "               ", 
      RowBox[{"r", " ", "=", " ", 
       RowBox[{"Pick", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "b1", ",", " ", "b2", ",", " ", "b3", ",", " ", "b4", ",", " ", 
           "b5", ",", " ", "b6", ",", " ", "b7", ",", " ", "b8", ",", " ", 
           "b9"}], "}"}], ",", " ", "L", ",", " ", "1"}], "]"}]}], ";", "\n", 
      "               ", 
      RowBox[{"r", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "a", "}"}], ",", " ", "r"}], "]"}], "]"}]}], ";", "\n",
       "               ", 
      RowBox[{"m", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c", "  ", "==", " ", "1"}], ",", " ", 
         RowBox[{"LinearModelFit", "[", 
          RowBox[{"v", ",", " ", "r", ",", " ", "r"}], "]"}], ",", " ", "\n", 
         "                      ", 
         RowBox[{"LinearModelFit", "[", 
          RowBox[{"v", ",", " ", "r", ",", " ", "r", ",", " ", 
           RowBox[{"IncludeConstantBasis", " ", "->", " ", "False"}]}], 
          "]"}]}], "]"}]}], ";", "\n", "               ", 
      RowBox[{"s", " ", "=", " ", 
       RowBox[{"m", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<ParameterTable\>\"", ",", " ", "\"\<RSquared\>\""}], 
         "}"}], "]"}]}], ";", "\n", "               ", 
      RowBox[{"Return", "[", "s", "]"}]}]}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"bc", "[", 
     RowBox[{"data_", ",", " ", "Pe_"}], "]"}], ":=", " ", "\n", "      ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "p", ",", " ", "lhs", ",", " ", "rhs", ",", " ", "\n", 
        "              ", "dpL1", ",", " ", "dpL2", ",", " ", "dpL3", ",", 
        " ", "dpL4", ",", " ", "dpL5", ",", " ", "dpL6", ",", " ", "dpL7", 
        ",", " ", "dpL8", ",", " ", "dpL9", ",", " ", "c"}], "}"}], ",", "\n",
       "             ", 
      RowBox[{
       RowBox[{"p", " ", "=", " ", "data"}], ";", "\n", "             ", 
       RowBox[{"lhs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{"p", ",", " ", "1"}], "]"}], " ", "-", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{"p", ",", " ", 
           RowBox[{"-", "1"}]}], "]"}]}]}], ";", "\n", "             ", 
       RowBox[{"rhs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{"p", ",", " ", 
           RowBox[{"-", "1"}]}], "]"}], " ", "-", " ", "Pe"}]}], ";", " ", 
       "\n", "             ", 
       RowBox[{"dpL1", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "0", "}"}], ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"lhs", ",", " ", 
            RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], ";", "\n", 
       "             ", 
       RowBox[{"dpL2", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"lhs", ",", " ", 
            RowBox[{"-", "2"}]}], "]"}]}], "]"}]}], ";", "\n", 
       "             ", 
       RowBox[{"dpL3", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"lhs", ",", " ", 
            RowBox[{"-", "3"}]}], "]"}]}], "]"}]}], ";", "\n", 
       "             ", 
       RowBox[{"dpL4", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], "}"}], 
          ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"lhs", ",", " ", 
            RowBox[{"-", "4"}]}], "]"}]}], "]"}]}], ";", "\n", 
       "             ", 
       RowBox[{"dpL5", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
           "}"}], ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"lhs", ",", " ", 
            RowBox[{"-", "5"}]}], "]"}]}], "]"}]}], ";", "\n", 
       "             ", 
       RowBox[{"dpL6", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
            ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"lhs", ",", " ", 
            RowBox[{"-", "6"}]}], "]"}]}], "]"}]}], ";", "\n", 
       "             ", 
       RowBox[{"dpL7", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
            ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"lhs", ",", " ", 
            RowBox[{"-", "7"}]}], "]"}]}], "]"}]}], ";", "\n", 
       "             ", 
       RowBox[{"dpL8", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
            ",", " ", "0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"lhs", ",", " ", 
            RowBox[{"-", "8"}]}], "]"}]}], "]"}]}], ";", "\n", 
       "             ", 
       RowBox[{"dpL9", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", 
            ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], 
           "}"}], ",", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"lhs", ",", " ", 
            RowBox[{"-", "9"}]}], "]"}]}], "]"}]}], ";", "\n", 
       "             ", 
       RowBox[{"{", 
        RowBox[{
        "rhs", ",", " ", "dpL1", ",", " ", "dpL2", ",", " ", "dpL3", ",", " ",
          "dpL4", ",", " ", "dpL5", ",", " ", "dpL6", ",", " ", "dpL7", ",", 
         " ", "dpL8", ",", " ", "dpL9", ",", " ", "lhs"}], "}"}]}]}], "]"}]}],
    "\n"}]}]], "Input",
 CellChangeTimes->{3.667219233459649*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LagTest", "[", 
  RowBox[{
   RowBox[{"PriceSequenceLags", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      ".3", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
     ".2", ",", "10", ",", "20", ",", "500", ",", "0.2"}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", " ", "0", ",", " ", "20"}], "]"}]], "Input",
 CellChangeTimes->{{3.6672189504649687`*^9, 3.667218968412828*^9}, {
  3.667219037581712*^9, 3.6672190409817796`*^9}, {3.667219107475119*^9, 
  3.6672191076851234`*^9}, {3.667219279665085*^9, 3.6672192866952257`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   StyleBox[
    TagBox[GridBox[{
       {"\<\"\"\>", "\<\"Estimate\"\>", "\<\"Standard Error\"\>", "\<\"t\
\[Hyphen]Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
       {"a", 
        RowBox[{"-", "0.20397508818420235`"}], "0.01194881528650729`", 
        RowBox[{"-", "17.07073741566102`"}], "9.771750112766282`*^-52"},
       {"b1", "0.2448739847351428`", "0.03444726698557494`", 
        "7.108662200623512`", "4.10582685102672`*^-12"},
       {"b3", "0.012936715539843704`", "0.03302862160690709`", 
        "0.39168196886358475`", "0.6954614352111217`"}
      },
      AutoDelete->False,
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
      GridBoxDividers->{
       "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
        "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
      GridBoxSpacings->{
       "ColumnsIndexed" -> {2 -> 1}, "RowsIndexed" -> {2 -> 0.75}}],
     "Grid"], "DialogStyle",
    StripOnInput->False], ",", "0.48236095418299374`"}], "}"}]], "Output",
 CellChangeTimes->{{3.667218958852637*^9, 3.6672189690928416`*^9}, 
   3.6672190029835196`*^9, 3.6672190416917934`*^9, {3.6672191032330246`*^9, 
   3.6672191081351323`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1664, 968},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{612, 792}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 69, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[639, 25, 109, 1, 49, "Subsection"],
Cell[CellGroupData[{
Cell[773, 30, 108, 1, 39, "Subsubsection"],
Cell[884, 33, 459, 7, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1380, 45, 102, 1, 39, "Subsubsection"],
Cell[1485, 48, 173, 3, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1695, 56, 120, 1, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[1840, 61, 1525, 41, 92, "Input"],
Cell[3368, 104, 320, 5, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3725, 114, 1251, 37, 92, "Input"],
Cell[4979, 153, 149, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5165, 161, 1319, 38, 92, "Input"],
Cell[6487, 201, 150, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6674, 209, 1318, 38, 92, "Input"],
Cell[7995, 249, 152, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8184, 257, 1318, 38, 92, "Input"],
Cell[9505, 297, 154, 4, 31, "Output"]
}, Open  ]],
Cell[9674, 304, 1306, 29, 92, "Input"],
Cell[CellGroupData[{
Cell[11005, 337, 1429, 40, 92, "Input"],
Cell[12437, 379, 241, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12715, 388, 1428, 40, 92, "Input"],
Cell[14146, 430, 271, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14454, 441, 1317, 38, 92, "Input"],
Cell[15774, 481, 174, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15985, 489, 1346, 39, 92, "Input"],
Cell[17334, 530, 203, 5, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17574, 540, 1366, 39, 92, "Input"],
Cell[18943, 581, 227, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19207, 590, 1349, 39, 92, "Input"],
Cell[20559, 631, 173, 3, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20781, 640, 118, 1, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[20924, 645, 1101, 20, 31, "Input"],
Cell[22028, 667, 1409, 30, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23474, 702, 539, 12, 31, "Input"],
Cell[24016, 716, 1106, 25, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25159, 746, 537, 12, 31, "Input"],
Cell[25699, 760, 1284, 29, 85, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27020, 794, 969, 18, 31, "Input"],
Cell[27992, 814, 1490, 32, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29519, 851, 964, 18, 31, "Input"],
Cell[30486, 871, 1551, 32, 85, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32074, 908, 856, 17, 31, "Input"],
Cell[32933, 927, 1599, 33, 102, "Output"]
}, Open  ]],
Cell[34547, 963, 909, 18, 52, "Input"],
Cell[35459, 983, 215, 4, 31, "Input"],
Cell[CellGroupData[{
Cell[35699, 991, 2056, 48, 92, "Input"],
Cell[37758, 1041, 101, 1, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37896, 1047, 1902, 46, 92, "Input"],
Cell[39801, 1095, 147, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39985, 1102, 1782, 44, 72, "Input"],
Cell[41770, 1148, 123, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41930, 1155, 1858, 45, 92, "Input"],
Cell[43791, 1202, 125, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43953, 1209, 1829, 44, 72, "Input"],
Cell[45785, 1255, 168, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45990, 1262, 1725, 43, 92, "Input"],
Cell[47718, 1307, 125, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47880, 1314, 1728, 43, 92, "Input"],
Cell[49611, 1359, 125, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49773, 1366, 1474, 39, 72, "Input"],
Cell[51250, 1407, 121, 2, 31, "Output"]
}, Open  ]],
Cell[51386, 1412, 572, 10, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51995, 1427, 118, 1, 39, "Subsubsection"],
Cell[52116, 1430, 456, 9, 31, "Input"],
Cell[52575, 1441, 2988, 74, 252, "Input"],
Cell[55566, 1517, 4973, 128, 352, "Input"],
Cell[CellGroupData[{
Cell[60564, 1649, 769, 16, 31, "Input"],
Cell[61336, 1667, 1280, 27, 85, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

